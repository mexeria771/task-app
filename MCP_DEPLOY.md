# Cloudflare MCPでのデプロイ手順

このタスク管理アプリをCloudflare MCPを使用してデプロイする手順です。

## 前提条件

1. Cloudflareアカウントを持っていること
2. Cloudflare MCPへのアクセス権を持っていること

## デプロイ手順

### 1. ファイルを圧縮する

まず、アプリの全ファイルをZIPファイルに圧縮します：

1. タスク管理アプリのルートディレクトリ（`C:\Users\mexer\PR\task-app`）にいることを確認
2. すべてのファイルを選択し、右クリックして「送る」→「圧縮 (zip形式) フォルダー」を選択
3. ZIP名は任意で良いですが、わかりやすいように「task-app.zip」などにしておくと良いでしょう

### 2. Cloudflare MCPにログイン

1. Cloudflareのダッシュボードにアクセス: https://dash.cloudflare.com/
2. ログイン後、MCPにアクセスするか、適切なセクションに移動

### 3. 新しいウェブサイトを作成

1. MCPダッシュボードから「ウェブサイト」または「サイト」などの新しいサイトを追加するオプションを選択
2. サイト名を入力（例: task-app.yourdomain.com または選択可能なサブドメイン）
3. 「ファイルアップロード」または「ホスティング」のセクションを選択

### 4. ZIPファイルをアップロード

1. 「ファイルをアップロード」または同様のボタンをクリック
2. 先ほど作成したZIPファイル（task-app.zip）を選択
3. アップロードボタンをクリック
4. 必要に応じて、展開オプション（「ZIPファイルを展開する」など）を選択

### 5. 設定を確認

1. ルートディレクトリが正しく設定されていることを確認（通常は「/」または自動検出）
2. インデックスファイルが「index.html」になっていることを確認
3. 必要に応じてカスタムドメインを設定（オプション）

### 6. デプロイを開始

「デプロイ」「公開」などのボタンをクリックしてデプロイを開始します。

### 7. Supabase設定の更新

デプロイが完了したら、Supabaseの接続設定を更新する必要があります：

1. デプロイされたサイトのURLをメモします
2. `js/config.js`ファイルを編集します：
   ```javascript
   // Supabase configuration
   const supabaseConfig = {
     url: 'あなたのSupabase URL',
     key: 'あなたのanon key',
     useLocalStorage: false // Supabaseを使用する場合はfalse
   };
   ```
3. 変更を保存して再度ZIPファイルを作成し、アップロードします

### 8. CORS設定の確認

Supabaseとの通信でCORSエラーが発生する場合は、Supabaseダッシュボードで以下の設定を行います：

1. プロジェクトダッシュボード → 「Settings」→「API」に移動
2. 「API Settings」セクションの「Additional link and CORS settings」で
3. 「Allowed origins」に、デプロイしたアプリのURLを追加（例：`https://task-app.yourdomain.com`）

## トラブルシューティング

### サイトが表示されない場合

- インデックスファイル（index.html）が正しいディレクトリにあることを確認
- ブラウザのキャッシュをクリア
- Cloudflareのキャッシュをパージ（ダッシュボードから可能）

### Supabaseとの接続エラー

- ブラウザの開発者ツールでネットワークエラーを確認
- Supabaseの認証情報（URL、API Key）が正しいことを確認
- CORSの設定が正しいことを確認

### ファイルサイズの問題

Cloudflare MCPには個々のファイルサイズの制限がある場合があります。大きなファイルがある場合は分割するか、圧縮して提供することを検討してください。
